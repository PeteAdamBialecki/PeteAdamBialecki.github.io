<!DOCTYPE html>
<html>

<head>
  <script src="d3.min.js" charset="utf-8"></script>
  <style>
    html {
      background: #777;
    }
  </style>
</head>

<body>
  <script>
    var h = 100;
    var w = 400;

    function showHeader(ds) {
      d3.select("body").append("h1")
        .text(ds.category + " Sales 2018");
    }

    function buildLine(ds) {
      var lineFun = d3.svg.line()
        .x(function(d) {
          return ((d.month - 20130001) / 3.25);
        })
        .y(function(d) {
          return h - d.sales;
        })
        .interpolate("linear");

      var svg = d3.select("body").append("svg").attr({
        width: w,
        height: h
      });

      var vis = svg.append("path")
        .attr({
          d: lineFun(ds.monthlySales),
          "stroke": "#222",
          "stroke-width": 2,
          "fill": "lightblue"
        })
    }


    //    Global var for data:

    d3.json("https://api.github.com/repos/bsullins/d3js-resources/contents/monthlySalesbyCategoryMultiple.json", function(error, data) {
      if (error) {
        console.log(error);
      } else {
        console.log(data);
      }

      var decodedData = JSON.parse(window.atob(data.content));

      console.log(decodedData.contents[0]);

      decodedData.contents.forEach(function(ds) {
        console.log(ds);
        showHeader(ds);
        buildLine(ds);
      })

    });
  </script>
</body>

</html>